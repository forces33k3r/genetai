<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - GenetAi</title>
    <link rel="stylesheet" href="./styles/main.css">
    <link rel="stylesheet" href="./styles/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Background Image -->
    <div class="background-image"></div>
    
    <header>
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <i class="fas fa-dna"></i>
                    <span>GenetAi</span>
                </div>
                <div class="nav-links">
                    <a href="index.html">Home</a>
                    <a href="index.html#how-it-works">How It Works</a>
                    <a href="index.html#features">Features</a>
                    <a href="index.html#pricing">Pricing</a>
                    <a href="dashboard.html" class="active">Dashboard</a>
                    <a href="docs.html">Documentation</a>
                </div>
                <div class="nav-actions">
                    <div class="wallet-connect">
                        <div class="wallet-status disconnected" id="walletStatus">Not Connected</div>
                        <div class="wallet-dropdown">
                            <button class="btn btn-primary" id="connectWalletBtn">Connect Wallet</button>
                            <div class="wallet-dropdown-content" id="walletDropdown" style="display: none;">
                                <button class="wallet-option" onclick="connectMetaMask()">
                                    <i class="fab fa-metamask"></i>
                                    MetaMask
                                </button>
                                <button class="wallet-option" onclick="connectWalletConnect()">
                                    <i class="fas fa-wallet"></i>
                                    WalletConnect
                                </button>
                            </div>
                        </div>
                        <div class="wallet-info">
                            <div class="wallet-address" id="walletAddress" style="display: none;"></div>
                            <div class="wallet-balance" id="walletBalance" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="dashboard-container">
        <div class="container">
            <!-- Dashboard Header with Live Data -->
            <div class="dashboard-header">
                <h1>Live Presale Dashboard</h1>
                <p>Real-time blockchain data from BSC Testnet - Contract: 0x783Ab31e81A0FA50F3D6a85bF9F2A7f8DDDdC75E</p>
                
                <div class="dashboard-key-metrics">
                    <div class="key-metric">
                        <div class="metric-value" id="totalRaisedUSD">$0</div>
                        <div class="metric-label">Total Raised (USD)</div>
                    </div>
                    <div class="key-metric">
                        <div class="metric-value">$1,000,000</div>
                        <div class="metric-label">Hard Cap (USD)</div>
                    </div>
                    <div class="key-metric">
                        <div class="metric-value" id="presaleProgress">0%</div>
                        <div class="metric-label">Progress</div>
                    </div>
                    <div class="key-metric">
                        <div class="metric-value" id="daysLeft">30</div>
                        <div class="metric-label">Days Left</div>
                    </div>
                </div>
            </div>

            <!-- Main Dashboard Grid -->
            <div class="dashboard-grid">
                <!-- Live Progress Section -->
                <div class="dashboard-card progress-section">
                    <div class="card-header">
                        <h3>Live Presale Progress</h3>
                        <span class="progress-percent" id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar-large">
                        <div class="progress-fill" id="progressBarFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-stats">
                        <div class="progress-stat">
                            <span class="stat-label">Raised (BNB)</span>
                            <span class="stat-value" id="raisedBNB">0</span>
                        </div>
                        <div class="progress-stat">
                            <span class="stat-label">Target (BNB)</span>
                            <span class="stat-value" id="targetBNB">0</span>
                        </div>
                        <div class="progress-stat">
                            <span class="stat-label">Remaining (BNB)</span>
                            <span class="stat-value" id="remainingBNB">0</span>
                        </div>
                    </div>
                </div>

                <!-- Live Contribution Stats -->
                <div class="dashboard-card contribution-stats">
                    <div class="card-header">
                        <h3>Live Contribution Statistics</h3>
                        <div class="last-updated" id="lastUpdated">Updating...</div>
                    </div>
                    <div class="contribution-grid">
                        <div class="contribution-metric">
                            <div class="metric-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-value" id="totalContributors">0</div>
                                <div class="metric-label">Total Contributors</div>
                            </div>
                        </div>
                        <div class="contribution-metric">
                            <div class="metric-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-value" id="averageContribution">0 BNB</div>
                                <div class="metric-label">Average Contribution</div>
                            </div>
                        </div>
                        <div class="contribution-metric">
                            <div class="metric-icon">
                                <i class="fas fa-coins"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-value" id="tokensSold">0</div>
                                <div class="metric-label">Tokens Sold</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Crypto Contribution Section -->
                <div class="dashboard-card crypto-payment">
                    <div class="card-header">
                        <h3>Contribute to Presale</h3>
                        <div class="connection-status">
                            <span class="status-dot disconnected" id="connectionStatus"></span>
                            <span id="networkStatus">BSC Testnet</span>
                        </div>
                    </div>

                    <!-- Wallet Connection -->
                    <div class="wallet-section">
                        <div class="wallet-info-compact" id="walletInfoCompact" style="display: none;">
                            <div class="wallet-address-compact" id="walletAddressCompact"></div>
                            <div class="wallet-balance-compact" id="walletBalanceCompact"></div>
                            <button class="btn btn-outline btn-sm" onclick="disconnectWallet()" style="margin-top: 0.5rem;">
                                Disconnect
                            </button>
                        </div>
                        <!-- REMOVED DUPLICATE WALLET BUTTONS HERE -->
                    </div>

                    <!-- Contribution Limits -->
                    <div class="contribution-limits">
                        <div class="limit-item">
                            <div class="limit-value" id="minContribution">0.01 BNB</div>
                            <div class="limit-label">Min Contribution</div>
                        </div>
                        <div class="limit-item">
                            <div class="limit-value" id="maxContribution">10 BNB</div>
                            <div class="limit-label">Max Contribution</div>
                        </div>
                    </div>

                    <!-- User Stats -->
                    <div class="user-stats" id="userStats" style="display: none;">
                        <div class="user-stat-item">
                            <span>Your Contribution:</span>
                            <span id="userContribution">0 BNB</span>
                        </div>
                        <div class="user-stat-item">
                            <span>Your Tokens:</span>
                            <span id="userTokens">0 $GENE</span>
                        </div>
                    </div>

                    <!-- Contribution Form -->
                    <div class="contribution-form">
                        <div class="input-group">
                            <input type="number" class="amount-input" id="contributionAmount" placeholder="Enter BNB amount" step="0.001" min="0.01" max="10">
                            <span class="input-suffix">BNB</span>
                        </div>
                        
                        <div class="amount-buttons">
                            <button class="amount-btn" onclick="setAmount(0.1)">0.1 BNB</button>
                            <button class="amount-btn" onclick="setAmount(0.5)">0.5 BNB</button>
                            <button class="amount-btn" onclick="setAmount(1)">1 BNB</button>
                            <button class="amount-btn" onclick="setAmount(5)">5 BNB</button>
                        </div>

                        <div class="token-calculation">
                            <div class="calculation-row">
                                <span>Token Price:</span>
                                <span id="tokenPriceDisplay">0.15 BNB</span>
                            </div>
                            <div class="calculation-row">
                                <span>You will receive:</span>
                                <span id="tokenAmount">0</span> $GENE
                            </div>
                        </div>

                        <button class="btn btn-primary" onclick="contribute()" style="width: 100%;" id="contributeBtn" disabled>
                            Connect Wallet to Contribute
                        </button>

                        <!-- Claim Section -->
                        <div class="claim-section" id="claimSection" style="display: none;">
                            <button class="btn btn-success" onclick="claimTokens()" style="width: 100%;">
                                Claim Your Tokens
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Live Token Metrics -->
                <div class="dashboard-card token-metrics">
                    <div class="card-header">
                        <h3>Live Token Metrics</h3>
                    </div>
                    <div class="token-stats">
                        <div class="token-stat">
                            <span class="stat-label">Token Price</span>
                            <span class="stat-value" id="liveTokenPrice">0.15 BNB</span>
                        </div>
                        <div class="token-stat">
                            <span class="stat-label">Tokens Sold</span>
                            <span class="stat-value" id="liveTokensSold">0</span>
                        </div>
                        <div class="token-stat">
                            <span class="stat-label">Total Supply</span>
                            <span class="stat-value">100,000,000</span>
                        </div>
                        <div class="token-stat">
                            <span class="stat-label">Presale Allocation</span>
                            <span class="stat-value">40%</span>
                        </div>
                    </div>
                </div>

                <!-- Contract Information -->
                <div class="dashboard-card contract-info">
                    <div class="card-header">
                        <h3>Contract Information</h3>
                    </div>
                    <div class="contract-details">
                        <div class="contract-item">
                            <span class="contract-label">Contract Address:</span>
                            <span class="contract-value">0x783Ab31e81A0FA50F3D6a85bF9F2A7f8DDDdC75E</span>
                        </div>
                        <div class="contract-item">
                            <span class="contract-label">Network:</span>
                            <span class="contract-value">BSC Testnet</span>
                        </div>
                        <div class="contract-item">
                            <span class="contract-label">Token Symbol:</span>
                            <span class="contract-value">$GENE</span>
                        </div>
                        <div class="contract-item">
                            <span class="contract-label">Block Explorer:</span>
                            <span class="contract-value">
                                <a href="https://testnet.bscscan.com/address/0x783Ab31e81A0FA50F3D6a85bF9F2A7f8DDDdC75E" target="_blank" style="color: var(--primary);">View on BscScan</a>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Transaction History -->
                <div class="dashboard-card transaction-history">
                    <div class="card-header">
                        <h3>Recent Contributions</h3>
                        <button class="btn btn-outline btn-sm" onclick="refreshTransactions()">Refresh</button>
                    </div>
                    <div class="transactions-list" id="transactionsList">
                        <div class="loading-transactions">Loading live transactions...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- WalletConnect Modal (Legacy; v2 handles QR internally, but kept for fallback) -->
    <div id="walletConnectModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Connect Wallet</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="walletConnectQR" style="text-align: center;"></div>
                <div style="text-align: center; margin-top: 1rem;">
                    <p>Scan QR code with your wallet app</p>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <div class="logo">
                        <i class="fas fa-dna"></i>
                        <span>GenetAi</span>
                    </div>
                    <p>Revolutionizing genetic analysis through blockchain technology and AI-powered insights.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-discord"></i></a>
                        <a href="#"><i class="fab fa-telegram"></i></a>
                        <a href="#"><i class="fab fa-github"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h4>Product</h4>
                    <ul class="footer-links">
                        <li><a href="index.html#how-it-works">How It Works</a></li>
                        <li><a href="index.html#features">Features</a></li>
                        <li><a href="index.html#pricing">Pricing</a></li>
                        <li><a href="docs.html">Documentation</a></li>
                        <li><a href="#">API</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>Company</h4>
                    <ul class="footer-links">
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Careers</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Press</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h4>Legal</h4>
                    <ul class="footer-links">
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="#">Data Processing</a></li>
                        <li><a href="#">Cookie Policy</a></li>
                        <li><a href="#">Compliance</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 GenetAi. All rights reserved. | Live blockchain data from BSC Testnet</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/web3@1.7.0/dist/web3.min.js"></script>
    <script src="https://unpkg.com/@walletconnect/ethereum-provider@2.14.0/dist/umd/index.min.js"></script>
    <script src="./scripts/dashboard.js"></script>
</body>
</html>